# PPT内容排版优化功能需求文档 v0.2

## 1. 需求背景

### 1.1 当前系统现状
当前AI PPTist系统已经实现了基础的PPT生成功能：
- 用户输入主题后，系统通过LLM大语言模型生成PPT大纲
- 根据大纲生成完整的幻灯片内容
- 通过预置的模板文档进行内容替换和排版
- 支持流式输出到前端生成PPT文档

### 1.2 问题分析
由于PPT内容的多样性和复杂性，预置模板的排版组织形式存在以下局限性：
- 无法适应所有类型的内容展示需求
- 排版布局相对固定，缺乏灵活性
- 难以针对特定内容进行智能优化
- 用户体验有待提升

### 1.3 解决方案
通过引入LLM大模型的智能排版能力，实现动态、智能的PPT内容排版优化功能，提升幻灯片的视觉效果和用户体验。

## 2. 功能概述

### 2.1 功能名称
PPT内容智能排版优化功能

### 2.2 功能目标
- 提供一键式智能排版优化能力
- 保持原有文字内容不变，仅优化排版布局
- 提升幻灯片的视觉效果和专业性
- 支持多种内容类型的智能适配

## 3. 详细需求

### 3.1 前端功能需求

#### 3.1.1 魔术按钮设计
- **位置**：在幻灯片编辑区的适当位置（建议右上角或工具栏区域）
- **样式**：醒目的魔术棒图标按钮，带有hover提示
- **交互**：
  - 点击按钮触发排版优化功能（该功能类似于Gamma的AI排版功能）
  - 点击后显示loading状态
  - 优化完成后自动更新幻灯片内容

#### 3.1.2 数据收集与传输
- 收集当前幻灯片的所有元素信息：
  - 标题元素（内容、位置、字体、颜色、大小等属性）
  - 文字元素（内容、位置、字体、颜色、大小等属性）
  - 形状元素（类型、位置、大小、颜色、边框等属性）
  - 图片元素（位置、大小、旋转角度等属性）
  - 其他元素（图表、表格等）

#### 3.1.3 内容渲染更新
- 接收后端返回的优化后数据
- 重新渲染幻灯片内容
- 保持用户编辑状态
- 提供撤销操作支持

#### 3.2.2 LLM交互流程
1. **数据预处理**：将幻灯片元素信息转换为LLM可理解的格式
2. **提示词设计**：设计专门的排版优化提示词，包含：
   - 保持文字内容不变的约束
   - 排版优化的目标（美观、合理、专业）
   - 可用的布局模式和设计原则
3. **HTML生成**：LLM返回优化后的HTML布局
4. **DOM解析**：解析HTML内容，提取布局信息

#### 3.2.3 数据转换
- 解析LLM返回的HTML内容
- 提取元素位置、大小、样式等信息
- 转换为前端编辑器可识别的数据结构
- 保持元素ID和关联关系

### 3.3 核心优化原则

#### 3.3.1 内容保持原则
- **文字内容不变**：所有文字内容必须保持原样，不得修改
- **语义完整性**：保持原有内容的语义关系和层次结构

#### 3.3.2 排版优化重点

##### 文字元素优化
- **位置调整**：根据内容重要性和视觉流线重新定位
- **大小优化**：根据内容层级调整字体大小
- **字体选择**：优化字体组合，提升可读性
- **颜色搭配**：优化文字颜色与背景的对比度

##### 形状元素优化
- **位置布局**：与文字内容形成合理的视觉关联
- **大小适配**：根据内容量调整形状尺寸
- **颜色协调**：优化填充色和边框色，与整体色调协调
- **背景设计**：优化形状底色，提升视觉效果

##### 整体布局优化
- **视觉平衡**：确保各元素在幻灯片中的平衡分布
- **层次清晰**：明确内容的主次关系
- **留白合理**：优化元素间距和边距
- **对齐一致**：保持元素的对齐方式一致性

## 4. 技术实现方案

### 4.1 前端实现
- 使用Vue3 Composition API管理状态
- 实现魔术按钮组件
- 优化数据序列化和反序列化
- 添加loading状态和错误处理

### 4.2 后端实现
- 使用FastAPI处理HTTP请求
- 集成LLM服务（OpenAI、Azure、本地模型等）
- 实现HTML解析和DOM操作
- 添加缓存机制提升性能

### 4.3 LLM提示词设计
```
你是一个专业的PPT设计师。请根据提供的幻灯片内容，优化其排版布局，使其更加美观和专业。

要求：
1. 保持所有文字内容完全不变
2. 优化文字的位置、大小、字体、颜色等样式属性
3. 优化形状的位置、大小、颜色、背景等属性
4. 确保整体布局平衡、层次清晰、留白合理
5. 返回优化后的HTML布局代码

当前幻灯片内容：[插入幻灯片数据]

请返回完整的HTML代码，包含所有优化后的元素布局。
```

## 5. 非功能性需求

### 5.1 性能要求
- 单次排版优化响应时间 < 5秒
- 支持并发请求处理
- 内存使用合理

### 5.2 可用性要求
- 提供清晰的用户反馈
- 支持操作撤销
- 错误处理友好

### 5.3 兼容性要求
- 兼容现有PPT编辑器
- 支持所有现有元素类型
- 保持数据格式一致性

## 6. 测试计划

### 6.1 功能测试
- 魔术按钮点击功能
- 数据收集完整性
- 排版优化效果
- 错误处理机制

### 6.2 集成测试
- 前后端数据交互
- LLM服务集成
- 数据转换准确性

### 6.3 用户体验测试
- 操作流程顺畅性
- 视觉效果提升
- 性能表现评估

## 7. 风险评估

### 7.1 技术风险
- LLM生成结果不稳定
- HTML解析复杂性
- 性能瓶颈

### 7.2 业务风险
- 用户接受度
- 效果预期管理
- 成本控制

## 8. 后续规划

### 8.1 功能扩展
- 支持多种排版风格选择
- 添加个性化偏好设置
- 集成更多设计原则

### 8.2 优化方向
- 提升排版算法的准确性
- 减少LLM调用成本
- 增强本地化处理能力

---

**文档版本**：v0.2
**创建日期**：2025-10-28
**更新说明**：新增PPT内容排版优化功能需求