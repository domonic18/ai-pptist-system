# Nano Banana Pro 文生图模型集成需求文档

## 1. 需求概述

基于 nano banana pro 文生图模型的强大能力，实现从传统模板套内容到直接生成 PPT 图片的转变，显著提升 PPT 排版的视觉效果和美观度。

## 2. 功能流程

### 2.1 用户交互流程

```
输入主题 → 生成大纲 → [新增]选择模板图片 → [新增]自动生成PPT图片
```

### 2.2 详细功能点

#### 2.2.1 大纲生成界面 (保持不变)
- **入口**: 用户点击右上角 AI 图标
- **功能**: 打开当前输入主题生成大纲的对话框
- **交互**: 用户点击 AI 生成按钮，系统根据主题生成大纲内容
- **位置**: `frontend/src/views/Editor/AIPPTDialog.vue` (步骤2: outline)

#### 2.2.2 新增模板选择功能
- **触发位置**: 在大纲界面下方新增按钮
- **按钮图标**: 🍌 香蕉图标（代表 nano banana pro 模型）
- **按钮文本**: "香蕉生成"
- **交互流程**:
  1. 用户点击香蕉按钮，打开新对话框
  2. 对话框中展示模板图片网格（多张图片预览）
  3. 用户点击选择某一张模板图片
  4. 选择后，下方的"自动生成"按钮变为可点击状态
- **UI设计**: 参考 `frontend/src/views/Editor/Thumbnails/Templates.vue`

#### 2.2.3 图片生成流程
- **触发条件**: 用户点击"自动生成"按钮
- **页面跳转**: 自动跳转到 PPT 编辑页面
- **幻灯片创建**:
  - 根据大纲规划的 PPT 页面数量，在左侧缩略图中创建对应的空幻灯片
  - 使用骨架图作为占位符，显示加载状态
  - 每页显示"正在生成图片..."或加载动画
- **生成过程**:
  - 系统逐页调用后端配置的 nano banana pro 模型
  - 生成对应幻灯片的完整图片
  - 图片尺寸需与幻灯片画布尺寸完全一致

#### 2.2.4 生成进度展示
- **位置**: 右上角浮动对话框（类似原标注系统）
 - **参考实现**: `frontend/src/components/image-generation/NavigationBar.vue` 或标注系统对话框
- **显示内容**:
  - 生成进度（第 X 页 / 总 Y 页）
  - 停止按钮（中断生成）
  - 重新生成按钮（重试失败的页面）

#### 2.2.5 生成结果展示
- **缩略图更新**: 每生成完成一页，左侧缩略图从骨架图更新为生成的图片缩略图
- **通知提示**: 所有幻灯片生成完成后，触发通知提示"幻灯片生成成功"
- **参考**: 复用现有的通知系统（如 `frontend/src/utils/message.ts`）

#### 2.2.6 错误处理
- **策略**: 某一页生成失败后，跳过该页继续生成下一页
- **日志**: 记录失败的页面编号和错误原因
- **用户提示**: 生成完成后，提示用户"X 页生成失败，可选择重试"


---

**文档版本**: v1.0
**创建日期**: 2025-12-20
**更新记录**:
- v1.0: 初始版本，包含完整功能需求和技术架构
